(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&e(c)}).observe(document,{childList:!0,subtree:!0});function a(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?o.credentials="include":t.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function e(t){if(t.ep)return;t.ep=!0;const o=a(t);fetch(t.href,o)}})();const i="2aa923dd520445aaa8958353cfe52b1d",l=new URLSearchParams(window.location.search),s=l.get("code"),d=window.location.href.includes("localhost")?"http://localhost:5173/callback":"https://j0hnc0yne.github.io/spotify-data/";s?h(i,s).then(r=>m(r,"long_term",50)).then(r=>{var a;((a=r==null?void 0:r.items)==null?void 0:a.map(({name:e,artists:t})=>`${e} by ${t.map(o=>o.name).join(", ")}`)).forEach(e=>{var t=document.getElementById("topTracks"),o=document.createElement("li");o.appendChild(document.createTextNode(e)),t&&t.appendChild(o)})}):p(i);function p(r){const n=u(128);f(n).then(a=>{sessionStorage.setItem("verifier",n);const e=new URLSearchParams;e.append("client_id",r),e.append("response_type","code"),e.append("redirect_uri",d),e.append("scope","user-top-read"),e.append("code_challenge_method","S256"),e.append("code_challenge",a),document.location=`https://accounts.spotify.com/authorize?${e.toString()}`})}function u(r){let n="",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let e=0;e<r;e++)n+=a.charAt(Math.floor(Math.random()*a.length));return n}async function f(r){const n=new TextEncoder().encode(r),a=await window.crypto.subtle.digest("SHA-256",n);return btoa(String.fromCharCode.apply(null,[...new Uint8Array(a)])).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function h(r,n){const a=sessionStorage.getItem("verifier"),e=new URLSearchParams;e.append("client_id",r),e.append("grant_type","authorization_code"),e.append("code",n),e.append("redirect_uri",d),e.append("code_verifier",a);const t=await fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:e}),{access_token:o}=await t.json();return o}async function m(r,n,a){return await(await fetch(`https://api.spotify.com/v1/me/top/tracks?time_range=${n}&limit=${a}`,{method:"GET",headers:{Authorization:`Bearer ${r}`}})).json()}
