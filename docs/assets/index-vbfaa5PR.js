(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver(t=>{for(const a of t)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&e(c)}).observe(document,{childList:!0,subtree:!0});function n(t){const a={};return t.integrity&&(a.integrity=t.integrity),t.referrerPolicy&&(a.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?a.credentials="include":t.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function e(t){if(t.ep)return;t.ep=!0;const a=n(t);fetch(t.href,a)}})();const i="2aa923dd520445aaa8958353cfe52b1d",d=new URLSearchParams(window.location.search),s=d.get("code");s?f(i,s).then(r=>h(r,"long_term",50)).then(r=>{var o;console.log((o=r==null?void 0:r.items)==null?void 0:o.map(({name:n,artists:e})=>`${n} by ${e.map(t=>t.name).join(", ")}`))}):l(i);function l(r){const o=p(128);u(o).then(n=>{sessionStorage.setItem("verifier",o);const e=new URLSearchParams;e.append("client_id",r),e.append("response_type","code"),e.append("redirect_uri","http://localhost:5173/callback"),e.append("scope","user-top-read"),e.append("code_challenge_method","S256"),e.append("code_challenge",n),document.location=`https://accounts.spotify.com/authorize?${e.toString()}`})}function p(r){let o="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let e=0;e<r;e++)o+=n.charAt(Math.floor(Math.random()*n.length));return o}async function u(r){const o=new TextEncoder().encode(r),n=await window.crypto.subtle.digest("SHA-256",o);return btoa(String.fromCharCode.apply(null,[...new Uint8Array(n)])).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function f(r,o){const n=sessionStorage.getItem("verifier"),e=new URLSearchParams;e.append("client_id",r),e.append("grant_type","authorization_code"),e.append("code",o),e.append("redirect_uri","http://localhost:5173/callback"),e.append("code_verifier",n);const t=await fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:e}),{access_token:a}=await t.json();return a}async function h(r,o,n){return await(await fetch(`https://api.spotify.com/v1/me/top/tracks?time_range=${o}&limit=${n}`,{method:"GET",headers:{Authorization:`Bearer ${r}`}})).json()}
